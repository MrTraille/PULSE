<!doctype html>
<html lang="fr" data-bs-theme="dark">
  <head>
    <meta charset="utf-8">
    <title>{% block title %}PULSE{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style2.css') }}">
    {% block head %}{% endblock %}
  </head>

<div class="modal fade" id="pulseTutorialModal"
     tabindex="-1"
     aria-hidden="true"
     data-bs-backdrop="static"
     data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content bg-dark border-secondary">
      <div class="modal-header border-secondary">
        <h5 class="modal-title mb-0">Bienvenue dans PULSE</h5>
      </div>
      <div class="modal-body small">
        <p>Cette app t'aide à planifier tes sorties&nbsp;:</p>
        <ul>
          <li><strong>Accueil</strong> : Créé ici tes projets et retrouve ta liste sous le formulaire.</li>
        </ul>
      </div>
      <div class="modal-footer border-secondary justify-content-center">
        <button type="button" class="btn btn-primary btn-sm" id="pulse-tuto-ok">
          Ok
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal d'aide par onglet (Aperçu / Checklist / Deadline) -->
<div class="modal fade" id="tabHelpModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content bg-dark border-secondary">
      <div class="modal-header border-secondary">
        <h5 class="modal-title mb-0 tab-help-title"></h5>
      </div>
      <div class="modal-body small tab-help-body">
        <!-- contenu rempli en JS -->
      </div>
      <div class="modal-footer border-secondary justify-content-center">
        <button type="button" class="btn btn-primary btn-sm tab-help-ok">
          Ok
        </button>
      </div>
    </div>
  </div>
</div>



  <body>
    <div class="app-shell">
      <div class="app-frame">
        <header class="app-header app-header-center">
          <img
            src="{{ url_for('static', filename='img/title.png') }}"
            alt="Pulse"
            class="app-logo-title"
          />
          <div class="app-subtitle mt-2">
            PLANNING DES UPLOAD, SORTIES ET ÉCHÉANCES
          </div>
        </header>

        <main class="app-main">
          {% block content %}{% endblock %}
        </main>

        <footer class="app-footer">
          v0.2 · Cyril Vincent
          <div class="d-none d-md-block small text-end text-muted">
            {{ datetime.utcnow().strftime("%d/%m/%Y") }}
          </div>
        </footer>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const shouldShow = {{ 'true' if show_intro_tutorial|default(false) else 'false' }};
        if (!shouldShow) return;

        const modalEl = document.getElementById("pulseTutorialModal");
        if (!modalEl) return;

        const modal = new bootstrap.Modal(modalEl);
        const okBtn = document.getElementById("pulse-tuto-ok");

        modal.show();

        if (okBtn) {
          okBtn.addEventListener("click", function () {
            fetch("{{ url_for('tutorial_seen') }}", {
              method: "POST"
            }).finally(function () {
              modal.hide();
            });
          });
        }
      });
    </script>



    {% block scripts %}{% endblock %}
  </body>
</html>
